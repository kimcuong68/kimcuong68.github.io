<!-- REPLACE WHOLE FILE: /store/trang-suc.html -->
<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>

  <title>Trang sức | Kim Cuong</title>
  <meta name="description" content="Trang sức, phụ kiện nhỏ xinh được Kim Cuong chọn lọc."/>
  <link rel="canonical" href="https://kimcuong68.github.io/store/trang-suc.html"/>
  <meta name="robots" content="index,follow"/>

  <meta property="og:title" content="Trang sức | Kim Cuong"/>
  <meta property="og:description" content="Nhẫn, vòng, dây chuyền, phụ kiện trang sức dễ phối."/>
  <meta property="og:url" content="https://kimcuong68.github.io/store/trang-suc.html"/>
  <meta property="og:image" content="https://kimcuong68.github.io/assets/og/trang-suc.webp"/>

  <link rel="stylesheet" href="/assets/site.css"/>
  <script defer src="/assets/analytics.js"></script>
  <script defer src="/assets/mxd-affiliate.js"></script>
</head>
<body>
<header class="topbar">
  <div class="container nav">
    <a class="brand" href="/">Kim Cuong</a>
    <nav>
      <a href="/">Trang chủ</a>
      <a href="/store.html">Cửa hàng</a>
      <a href="/store/thoi-trang.html">Thời trang</a>
      <a href="/store/my-pham.html">Mỹ phẩm</a>
      <a href="/store/me-va-be.html">Mẹ & Bé</a>
      <a href="/store/trang-suc.html">Trang sức</a>
      <a href="/lien-he.html">Liên hệ</a>
    </nav>
  </div>
</header>

<main class="container" style="padding-top:24px;padding-bottom:40px">
  <h1>Trang sức</h1>
  <p class="muted">Lọc theo danh mục <code>trang-suc</code> trong affiliates.json.</p>

  <div id="grid" class="product-grid">
    <p>Đang tải…</p>
  </div>
</main>

<footer>
  <div class="container">
    <small class="muted">Dữ liệu: affiliates.json • category = trang-suc</small>
  </div>
</footer>

<script>
  const CATEGORY_SLUG = 'trang-suc';

  function priceText(v){
    const n = Number(v);
    return Number.isFinite(n) ? n.toLocaleString('vi-VN') + ' ₫' : '';
  }

  function imgPath(p){
    return p.image || ('/assets/img/products/' + p.sku + '.webp');
  }

  function matchesCategory(p){
    const c = (p.category || '').toLowerCase();
    return c.startsWith(CATEGORY_SLUG);
  }

  function card(p){
    const origin = p.origin_url ?? p.origin ?? '#';
    const priceRaw = p.price_vnd ?? p.price;
    const price = priceText(priceRaw);
    return `
      <div class="card product-card">
        <a class="product-meta"
           href="${origin}"
           data-merchant="${p.merchant || ''}"
           data-sku="${p.sku}"
           data-img="${imgPath(p)}"
           ${Number.isFinite(Number(priceRaw)) ? `data-price="${Number(priceRaw)}"` : ''}>
           ${p.name}
        </a>
        <img src="${imgPath(p)}" alt="${p.name}"/>
        ${price ? `<p><strong>${price}</strong></p>` : ''}
        <p><span class="badge">${p.merchant || ''}</span></p>
        <p><a class="btn buy" href="#">Mua ngay</a></p>
      </div>`;
  }

  async function loadAffiliates(){
    const candidates = ['/assets/data/affiliates.json', '/affiliates.json'];
    for (const url of candidates){
      try{
        const r = await fetch(url, {cache:'no-store'});
        if (r.ok) return await r.json();
      }catch(e){}
    }
    return [];
  }

  (async () => {
    const wrap = document.getElementById('grid');
    try{
      const list = await loadAffiliates();
      const items = list.filter(matchesCategory);
      wrap.innerHTML = items.length
        ? items.map(card).join('')
        : '<p>Chưa có sản phẩm trang sức nào.</p>';
    }catch(e){
      wrap.innerHTML = '<p>Lỗi tải danh sách sản phẩm.</p>';
    }
  })();

  if ('serviceWorker' in navigator){
    navigator.serviceWorker.register('/sw.js').catch(()=>{});
  }
</script>
</body>
</html>
